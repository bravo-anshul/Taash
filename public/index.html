<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
        <title>Babylon Template</title>

        <style>
            html, body {
                overflow: hidden;
                width: 100%;
                height: 100%;
                margin: 0;
                padding: 0;
            }

            #renderCanvas {
                width: 100%;
                height: 100%;
                touch-action: none;
            }
        </style>
        <meta name="viewport" content="width=device-width, initial-scale=1">	
        <meta name="viewport" content="minimal-ui, width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
        <script type="text/javascript" src="Card.js"></script>
        <script type="text/javascript" src="Card2.js"></script>
        <script src="https://preview.babylonjs.com/babylon.max.js"></script>
        <script src="https://preview.babylonjs.com/babylon.js"></script>
        <script src="https://preview.babylonjs.com/loaders/babylonjs.loaders.min.js"></script>
        <script type="text/javascript" src="https://cdn.socket.io/socket.io-1.4.5.js"></script>
    </head>

   <body>
    <!-- <button onclick="openFullscreen();">Open Fullscreen</button> -->
    <canvas id="renderCanvas" ></canvas>
    <script>
        
        var canvas = document.getElementById("renderCanvas"); 

        var engine = new BABYLON.Engine(canvas, true);
        
        var createScene = function(){
            
            var scene = new BABYLON.Scene(engine);
            var light = new BABYLON.HemisphericLight("light1", new BABYLON.Vector3(1, 1, 1), scene);
            light.intensity = 15;
            var cameraPosition = new BABYLON.Vector3(0,2,-2);
            var camera = new BABYLON.ArcRotateCamera("Camera", -Math.PI / 2, 1.2, 6, cameraPosition, scene);
            camera.attachControl(canvas, true);

            var ground = BABYLON.MeshBuilder.CreateGround("ground", {height: 5, width: 5, subdivisions: 4}, scene);

            var firstPlayerCardPosition = {
                xAxis : -1,
                yAxis : 2,
                zAxis : -1.5,
                yAxisRotation : 0
            }
            
            var secondPlayerCardPosition = {
                xAxis : -3,
                yAxis : 2.5,
                zAxis : -1.5,
                yAxisRotation : 2
            }
            var thirdPlayerCardPosition = {
                xAxis : -2,
                yAxis : 2.5,
                zAxis : 3,
                yAxisRotation : 3
            }
            var fourthPlayerCardPosition = {
                xAxis : 3,
                yAxis : 2.5,
                zAxis : -1.5,
                yAxisRotation : 4
            }

            var firstPlayerArray = [];
            var secondPlayerArray = [];
            var thirdPlayerArray = [];
            var fourthPlayerArray = [];
            
            console.log(firstPlayerCardPosition);
            console.log(secondPlayerCardPosition);
            console.log(thirdPlayerCardPosition);
            console.log(fourthPlayerCardPosition);

            for(var i=0,x=0,z=0;i<13;i++,x+=0.2,z-=0.01){
                var tempCard = new CardClass2(firstPlayerCardPosition.xAxis+x,                         
                                            firstPlayerCardPosition.yAxis,
                                            firstPlayerCardPosition.zAxis+z,
                                            firstPlayerCardPosition.yAxisRotation);
                firstPlayerArray.push(tempCard);
            }
            for(var i=0,x=0,z=0;i<13;i++,x+=0.2,z-=0.01){
                var tempCard = new CardClass2(secondPlayerCardPosition.xAxis,                         
                                            secondPlayerCardPosition.yAxis,
                                            secondPlayerCardPosition.zAxis+x,
                                            secondPlayerCardPosition.yAxisRotation);
                secondPlayerArray.push(tempCard);
            }

            async function Tutor1() {
                for(var i=0;i<13;i++){
                    firstPlayerArray[i].playAnimation();
                    await sleep(200);
                }
                
            }
            async function Tutor() {
                for(var i=0;i<13;i++){
                    secondPlayerArray[i].playAnimation();
                    await sleep(200);
                }
                
            }
            Tutor1();
            Tutor();
            
            // BABYLON.SceneLoader.Append("", "earth.obj", scene, function (scene) {
            //     // do something with the scene
            // });

            

            return scene;
        }
        var scene = createScene();
        scene.getEngine().setHardwareScalingLevel(0.5)
        engine.runRenderLoop(function(){
            scene.render();
        });
        
        var elem = document.documentElement;
        function openFullscreen() {
            if (elem.requestFullscreen) {
                elem.requestFullscreen();
            } else if (elem.mozRequestFullScreen) { /* Firefox */
                elem.mozRequestFullScreen();
            } else if (elem.webkitRequestFullscreen) { /* Chrome, Safari & Opera */
                elem.webkitRequestFullscreen();
            } else if (elem.msRequestFullscreen) { /* IE/Edge */
                elem.msRequestFullscreen();
            }
        }
        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }
    </script>

   </body>

</html>